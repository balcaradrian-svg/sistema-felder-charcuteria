// ============================================
// CATÁLOGO DE PRODUCTOS FELDER - ACTUALIZADO
// ============================================

// Catálogo basado en la lista de precios oficial de Felder Charcutería
window.productData = {
    // SALAZONES
    salazones: [
        {
            nombre: "Bondiola",
            precio: 15020,
            unidad: "kg",
            presentacion: "por blíster de 100grs o pieza completa",
            categoria: "salazones"
        },
        {
            nombre: "Solomillo",
            precio: 15020,
            unidad: "kg", 
            presentacion: "por blíster de 100grs o pieza completa",
            categoria: "salazones"
        },
        {
            nombre: "Panceta",
            precio: 14680,
            unidad: "kg",
            presentacion: "por blíster de 100grs o pieza completa", 
            categoria: "salazones"
        }
    ],

    // FERMENTADOS
    fermentados: [
        {
            nombre: "Salame Tradicional",
            precio: 14438,
            unidad: "kg",
            presentacion: "venta por kg",
            categoria: "fermentados"
        },
        {
            nombre: "Salame al Vino", 
            precio: 14438,
            unidad: "kg",
            presentacion: "venta por kg",
            categoria: "fermentados"
        },
        {
            nombre: "Salame con Nueces",
            precio: 16430,
            unidad: "kg",
            presentacion: "venta por kg",
            categoria: "fermentados"
        },
        {
            nombre: "Cantimpalo",
            precio: 12620,
            unidad: "kg",
            presentacion: "venta por kg",
            categoria: "fermentados"
        },
        {
            nombre: "Chistorra",
            precio: 12620,
            unidad: "kg", 
            presentacion: "venta por kg",
            categoria: "fermentados"
        }
    ],

    // EMBUTIDOS
    embutidos: [
        {
            nombre: "Cracovia (tipo de salchicha)",
            precio: 8500,
            unidad: "unidad",
            presentacion: "por unidad de 200grs aprox",
            categoria: "embutidos"
        },
        {
            nombre: "Butifarra",
            precio: 7490,
            unidad: "unidad",
            presentacion: "por unidad de 200grs aprox",
            categoria: "embutidos"
        },
        {
            nombre: "Salchicha alemana",
            precio: 6500,
            unidad: "unidad",
            presentacion: "por unidad de 200grs aprox",
            categoria: "embutidos"
        },
        {
            nombre: "Salchicha parillera",
            precio: 6800,
            unidad: "kg",
            presentacion: "venta por kg",
            categoria: "embutidos"
        },
        {
            nombre: "Morcillón",
            precio: 4500,
            unidad: "kg",
            presentacion: "por horma por kilo u horma familiar de 300grs",
            categoria: "embutidos"
        },
        {
            nombre: "Morcilla Negra",
            precio: 3500,
            unidad: "kg",
            presentacion: "venta por kg",
            categoria: "embutidos"
        },
        {
            nombre: "Morcilla Blanca",
            precio: 4000,
            unidad: "kg",
            presentacion: "venta por kg", 
            categoria: "embutidos"
        },
        {
            nombre: "Morcilla Vasca",
            precio: 7000,
            unidad: "kg",
            presentacion: "venta por kg",
            categoria: "embutidos"
        },
        {
            nombre: "Jamón cocido",
            precio: 6600,
            unidad: "kg",
            presentacion: "por horma por kilo u horma familiar de 300grs",
            categoria: "embutidos"
        },
        {
            nombre: "Mortadela",
            precio: 11050,
            unidad: "kg",
            presentacion: "por horma por kilo u horma familiar de 300grs",
            categoria: "embutidos"
        }
    ],

    // FIAMBRES DE MÚSCULO ENTERO
    fiambres: [
        {
            nombre: "Jamón cocido",
            precio: 15850,
            unidad: "kg",
            presentacion: "pieza completa x kg",
            categoria: "fiambres"
        },
        {
            nombre: "Bondiola",
            precio: 13680,
            unidad: "kg",
            presentacion: "pieza completa x kg",
            categoria: "fiambres"
        },
        {
            nombre: "Bondiola ahumada",
            precio: 13980,
            unidad: "kg",
            presentacion: "pieza completa x kg",
            categoria: "fiambres"
        },
        {
            nombre: "Solomillo",
            precio: 13680,
            unidad: "kg",
            presentacion: "pieza completa x kg",
            categoria: "fiambres"
        },
        {
            nombre: "Solomillo ahumado",
            precio: 13980,
            unidad: "kg",
            presentacion: "pieza completa x kg", 
            categoria: "fiambres"
        },
        {
            nombre: "Panceta",
            precio: 11260,
            unidad: "kg",
            presentacion: "pieza de 3kg",
            categoria: "fiambres"
        },
        {
            nombre: "Panceta ahumada",
            precio: 11690,
            unidad: "kg",
            presentacion: "pieza de 3kg",
            categoria: "fiambres"
        },
        {
            nombre: "Pastrón",
            precio: 16760,
            unidad: "kg",
            presentacion: "pieza completa x kg",
            categoria: "fiambres"
        },
        {
            nombre: "Lomo",
            precio: 18420,
            unidad: "kg", 
            presentacion: "pieza completa x kg",
            categoria: "fiambres"
        },
        {
            nombre: "Peceto",
            precio: 18420,
            unidad: "kg",
            presentacion: "pieza completa x kg",
            categoria: "fiambres"
        }
    ],

    // FRESCOS CERDO
    frescos: [
        {
            nombre: "Pechito",
            precio: 5770,
            unidad: "kg",
            presentacion: "pieza completa x kg",
            categoria: "frescos"
        },
        {
            nombre: "Carré",
            precio: 5530,
            unidad: "kg",
            presentacion: "pieza completa x kg",
            categoria: "frescos"
        },
        {
            nombre: "Duo (pechito y carré)",
            precio: 5660,
            unidad: "kg",
            presentacion: "pieza completa x kg",
            categoria: "frescos"
        },
        {
            nombre: "Churrasquito",
            precio: 7820,
            unidad: "kg",
            presentacion: "pieza completa x kg",
            categoria: "frescos"
        },
        {
            nombre: "Matambre",
            precio: 10370,
            unidad: "kg",
            presentacion: "pieza completa x kg",
            categoria: "frescos"
        },
        {
            nombre: "Solomillo fresco",
            precio: 8350,
            unidad: "kg",
            presentacion: "pieza completa x kg",
            categoria: "frescos"
        },
        {
            nombre: "Bondiola fresca",
            precio: 7120,
            unidad: "kg",
            presentacion: "pieza completa x kg",
            categoria: "frescos"
        },
        {
            nombre: "Jamón con cuero y hueso",
            precio: 4290,
            unidad: "kg",
            presentacion: "pieza completa x kg",
            categoria: "frescos"
        },
        {
            nombre: "Paleta con cuero y hueso",
            precio: 3940,
            unidad: "kg",
            presentacion: "pieza completa x kg",
            categoria: "frescos"
        },
        {
            nombre: "Pulpa",
            precio: 6520,
            unidad: "kg",
            presentacion: "en bolsa de 10 kg",
            categoria: "frescos"
        },
        {
            nombre: "Nalga",
            precio: 7500,
            unidad: "kg",
            presentacion: "pieza completa x kg",
            categoria: "frescos"
        },
        {
            nombre: "Recorte",
            precio: 4000,
            unidad: "kg",
            presentacion: "en bolsa de 5 kg",
            categoria: "frescos"
        },
        {
            nombre: "Tocino",
            precio: 2500,
            unidad: "kg", 
            presentacion: "en bolsa de 5 kg",
            categoria: "frescos"
        },
        {
            nombre: "Tocino Cubeteado",
            precio: 3200,
            unidad: "kg",
            presentacion: "en bolsa de 5 kg",
            categoria: "frescos"
        },
        {
            nombre: "Cuero",
            precio: 750,
            unidad: "kg",
            presentacion: "en bolsa de 5 kg",
            categoria: "frescos"
        },
        {
            nombre: "Pata",
            precio: 750,
            unidad: "kg",
            presentacion: "en bolsa de 5 kg",
            categoria: "frescos"
        }
    ],

    // OTROS ELABORADOS
    elaborados: [
        {
            nombre: "Milanesa de Cerdo",
            precio: 5600,
            unidad: "kg",
            presentacion: "en bolsa de 5 kg",
            categoria: "elaborados"
        },
        {
            nombre: "Milanesa de Carne",
            precio: 8000,
            unidad: "kg",
            presentacion: "en bolsa de 5 kg",
            categoria: "elaborados"
        },
        {
            nombre: "Milanesa de Pollo",
            precio: 6500,
            unidad: "kg",
            presentacion: "en bolsa de 5 kg",
            categoria: "elaborados"
        },
        {
            nombre: "Chorizo Puro Cerdo",
            precio: 5870,
            unidad: "kg",
            presentacion: "gancho de 5 kg",
            categoria: "elaborados"
        },
        {
            nombre: "Chorizo Morrón y Chédar",
            precio: 7400,
            unidad: "kg",
            presentacion: "gancho de 5 kg",
            categoria: "elaborados"
        },
        {
            nombre: "Hamburguesa de Cerdo",
            precio: 5585,
            unidad: "kg",
            presentacion: "en bolsa de 5 kg",
            categoria: "elaborados"
        },
        {
            nombre: "Hamburguesa de Carne", 
            precio: 7200,
            unidad: "kg",
            presentacion: "en bolsa de 5 kg",
            categoria: "elaborados"
        },
        {
            nombre: "Carne Picada",
            precio: 6000,
            unidad: "kg",
            presentacion: "en bolsa de 5 kg",
            categoria: "elaborados"
        }
    ]
};

// ============================================
// FUNCIONES DE UTILIDAD PARA PRODUCTOS
// ============================================

// Obtener todos los productos de una categoría
function getProductsByCategory(categoria) {
    return window.productData[categoria] || [];
}

// Buscar producto por nombre
function findProductByName(nombre) {
    for (const categoria in window.productData) {
        const producto = window.productData[categoria].find(p => p.nombre === nombre);
        if (producto) {
            return producto;
        }
    }
    return null;
}

// Obtener todas las categorías disponibles
function getAvailableCategories() {
    return Object.keys(window.productData);
}

// Buscar productos por término de búsqueda
function searchProducts(searchTerm) {
    const results = [];
    const term = searchTerm.toLowerCase();
    
    for (const categoria in window.productData) {
        const productos = window.productData[categoria].filter(p => 
            p.nombre.toLowerCase().includes(term)
        );
        results.push(...productos);
    }
    
    return results;
}

// Obtener producto más caro y más barato por categoría
function getPriceRangeByCategory(categoria) {
    const productos = window.productData[categoria] || [];
    if (productos.length === 0) return null;
    
    const precios = productos.map(p => p.precio);
    return {
        min: Math.min(...precios),
        max: Math.max(...precios),
        categoria: categoria
    };
}

// Obtener estadísticas generales del catálogo
function getCatalogStats() {
    let totalProductos = 0;
    let precioMinimo = Infinity;
    let precioMaximo = 0;
    let sumaPrecios = 0;
    
    for (const categoria in window.productData) {
        const productos = window.productData[categoria];
        totalProductos += productos.length;
        
        productos.forEach(producto => {
            if (producto.precio < precioMinimo) precioMinimo = producto.precio;
            if (producto.precio > precioMaximo) precioMaximo = producto.precio;
            sumaPrecios += producto.precio;
        });
    }
    
    return {
        totalProductos: totalProductos,
        totalCategorias: Object.keys(window.productData).length,
        precioMinimo: precioMinimo,
        precioMaximo: precioMaximo,
        precioPromedio: Math.round(sumaPrecios / totalProductos)
    };
}

// ============================================
// INFORMACIÓN ADICIONAL DE LA EMPRESA
// ============================================

// Datos de contacto y empresa
window.companyInfo = {
    nombre: "Felder - Charcutería y carnicería",
    direccion: "Av. Almafuerte 5550 - Paraná, E.R.",
    telefono: "(343) 5019486",
    instagram: "feldercharcuteria",
    coordenadas: { lat: -31.7333, lng: -60.5167 },
    
    // Condiciones comerciales
    condiciones: {
        compraMinima: {
            salazones: "3 kg",
            fermentados: "3 kg", 
            fiambres: "una horma (entre 2,5 y 3 kg) o horma familiar 10 unidades",
            frescos: "10 kg",
            elaborados: "10 kg"
        },
        diasReparto: ["Martes", "Viernes"],
        costoReparto: "Sin costo",
        envasadoVacio: 2500, // Costo adicional por kg
        observaciones: [
            "Fiambres de músculo entero no se fraccionan",
            "Las piezas se cortan a gusto del cliente con aviso al momento de realizar el pedido",
            "El reparto se realiza los días martes y viernes sin costo alguno"
        ]
    }
};

// Zonas de entrega
window.deliveryZones = [
    "Paraná",
    "San Benito", 
    "Colonia Avellaneda"
];

// ============================================
// FUNCIONES DE VALIDACIÓN
// ============================================

// Validar cantidad mínima según categoría
function validateMinimumQuantity(categoria, cantidad) {
    const minimos = {
        salazones: 3,
        fermentados: 3,
        fiambres: 1, // 1 horma
        frescos: 10,
        elaborados: 10
    };
    
    return cantidad >= (minimos[categoria] || 1);
}

// Calcular costo de envasado al vacío
function calculateVacuumCost(peso) {
    return peso * window.companyInfo.condiciones.envasadoVacio;
}

// Verificar si una fecha es día de reparto
function isDeliveryDay(fecha) {
    const date = new Date(fecha);
    const dayOfWeek = date.getDay();
    return dayOfWeek === 2 || dayOfWeek === 5; // Martes o Viernes
}

// ============================================
// EXPORTAR FUNCIONES
// ============================================

// Exponer funciones globalmente
window.getProductsByCategory = getProductsByCategory;
window.findProductByName = findProductByName;
window.getAvailableCategories = getAvailableCategories;
window.searchProducts = searchProducts;
window.getPriceRangeByCategory = getPriceRangeByCategory;
window.getCatalogStats = getCatalogStats;
window.validateMinimumQuantity = validateMinimumQuantity;
window.calculateVacuumCost = calculateVacuumCost;
window.isDeliveryDay = isDeliveryDay;

console.log('Catálogo de productos Felder cargado:', getCatalogStats());